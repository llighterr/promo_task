# Задание по рефакторингу
Оригинальное условие находится [здесь](https://gist.github.com/NARKOZ/e7daf5f34d236f58e0237be7b1de85b6)

## Что изменилось и почему
Основное усилие по рефакторингу сводилось к тому, чтобы вынести из контролера логику по обработке и представлению данных в соответствующие файлы,
оставив при этом только экшны в роли эндпоинтов, рендер и редиректы.

1. Добавлен `ApplicationRecord` в цепочку наследования моделей
2. Логика запросов к БД вынесена из контролера в соответствующие модели
3. Добавлен декоратор для импорта таблицы пользователей в CSV файл. Импорт стал более универсальным (не зависит от списка колонок),
и должен лучше исплользовать доступную память с помощью `#find_each`.
4. Основная логика метода `#create` была перенесена в отдельный интерактор. Получилось немного громоздко, но как по мне теперь разделеней обязанностей (SRP) стало более чётко выраженым.
Также добавлена обработка ошибок в случае несохранения `PromoMessage`
5. Мелкие исправления стиля кода на тот, которым пользуюсь каждый день
6. Список всех изменений с описаниями к каждому коммиту можно почитать [здесь](https://github.com/llighterr/promo_task/commits/master)

## C какими проблемами столкнулся в процессе
Было трудно делать рефакторинг видя только кусочек 'виртуального' проекта,
не понимая специфики проекта, размеров, нагрузки на приложение и т.д.
В реальной задаче код мог бы выглядеть немного по другому.

## Любые идеи и мысли, чтобы еще сделал при наличии дополнительного времени, и т.д.
Вместо самописных сервисов и делегаторов я б использовал проверенные временем библиотеки, типа `Draper`, `Interactors` и т.д.
Возможно, попробовал использование готовой архитектуры `Trailblazer` или отдельных её частей.
Генерацию CSV можно вынести на уровень БД.
